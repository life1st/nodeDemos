<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Login</title>
</head>
<body>
<form>
  <label for="username">username:</label>
  <input type="text" id="username">
  <label for="password">password:</label>
  <input type="password" id="password">
</form>
<button id="login">Login</button>
<button id="register">Register</button>
<div class="result" id="result"></div>
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<script>
  const API_BASE = 'http://localhost:3003'
  let userEl = document.querySelector('#username')
  let passEl = document.querySelector('#password')
  let resEl = document.querySelector('#result')

  let loginBtn = document.querySelector('#login')
  loginBtn.addEventListener('click', () => {
    let username = userEl.value
    let password = passEl.value
    if (username && password) {
      axios.post(`${API_BASE}/login`, {
        username, password
      }).then(res => {
        let data = res.data
        if (data.ok) {
          resEl.innerText = `OK, ${data.msg}`
        } else {
          resEl.innerText = `ERR, ${data.msg}`
        }
      }).catch(err => {
        resEl.innerText = `ERR, network wrong`
      })
    } else {
      resEl.innerText = `ERR, input your info`
    }
  })

  let registerBtn = document.querySelector('#register')
  registerBtn.addEventListener('click', () => {
    let username = userEl.value
    let password = passEl.value
    if (username && password) {
      axios.post(`${API_BASE}/register`, {
        username, password
      }).then(res => {
        let data = res.data
        if (data.ok) {
          resEl.innerText = `OK, ${data.msg}`
        } else {
          resEl.innerText = `Err, ${data.msg}`
        }
      }).catch(err => {
        resEl.innerText = `ERR, bed network`
      })
    } else {
      resEl.innerText = `ERR, input your info`
    }
  })

  function autoRegister() {
    let name = () => `bot${new Date().getTime()}`
    let pass = () => `password${Math.random()}`

    userEl.value = name()
    passEl.value = pass()
    registerBtn.click()
  }

  // setInterval(() => {
  //   autoRegister()
  //   console.log('registering...')
  // }, 0)
</script>
</body>
</html>